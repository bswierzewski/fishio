# 🐟 Fishio — Nowoczesna Platforma dla Organizatorów Zawodów 🎣

> Budujemy społeczność 👥, upraszczamy organizację ⚙️, celebrujemy zwycięstwa 🏆.

**Fishio** to nowoczesna platforma webowa, zoptymalizowana pod kątem urządzeń mobilnych, służąca do kompleksowej organizacji i uczestnictwa w zawodach wędkarskich. Niezależnie od tego, czy organizujesz duże, komercyjne wydarzenie, **wieloetapową ligę z punktacją generalną**, czy po prostu nieformalne spotkanie z przyjaciółmi nad wodą, Fishio dostarcza wszystkich narzędzi potrzebnych do łatwej organizacji, rejestracji, **pobierania opłat** i śledzenia wyników na żywo.

## 🎯 Jak to działa?

Przepływ informacji i interakcji w Fishio został zaprojektowany tak, aby był intuicyjny zarówno dla organizatorów, jak i uczestników.

1.  **Utworzenie Zawodów:** Organizator tworzy nowe zawody, konfigurując wszystkie szczegóły: nazwę, datę, regulamin, opłatę wpisową oraz definiując dowolną liczbę klasyfikacji (np. "Największa Ryba", "Suma Wag", "Najlepszy Junior", "Punktacja za gatunki").
2.  **Udostępnienie Linku:** System generuje unikalny, publiczny link do strony zawodów. Organizator może go udostępnić na forach internetowych, w mediach społecznościowych lub wysłać bezpośrednio do zainteresowanych.
3.  **Zapisy Uczestników:** Każdy, kto otrzyma link, może wejść na stronę zawodów i dołączyć do listy startowej. Jeśli zawody są płatne, system automatycznie przekieruje uczestnika do bramki płatności w celu uiszczenia opłaty.
4.  **Zarządzanie Zgłoszeniami:** Organizator ma pełną kontrolę nad listą uczestników. Może akceptować lub odrzucać zgłoszenia, **ręcznie dodawać gości (uczestników bez konta w systemie)** oraz na bieżąco monitorować status płatności każdego zawodnika.
5.  **Wyznaczenie Sędziów:** Organizator może nadać uprawnienia sędziego wybranym użytkownikom. Sędziowie uzyskują dostęp do specjalnego panelu umożliwiającego rejestrację połowów.
6.  **Rejestracja Połowów:** W trakcie zawodów, tylko organizator i wyznaczeni sędziowie mogą dodawać ryby do systemu. Robią to za pomocą prostego formularza na urządzeniu mobilnym, wybierając zawodnika z listy i wpisując wagę lub długość ryby.
7.  **Wyniki na Żywo:** Wszystkie zarejestrowane połowy natychmiast aktualizują tabele wyników. Każdy (uczestnik, kibic, organizator) może śledzić rywalizację w czasie rzeczywistym na publicznej stronie wyników, przełączając się między zdefiniowanymi klasyfikacjami.

## ⚙️ Elastyczna Konfiguracja Zawodów — Dopasuj Zasady do Swoich Potrzeb

W Fishio rozumiemy, że każde zawody są inne. Dlatego dajemy organizatorom pełną swobodę w definiowaniu zasad, według których wyłaniani są zwycięzcy. Zapomnij o sztywnych ramach — stwórz unikalne wydarzenie z własnymi regułami gry.

### 🏆 Krok 1: Zdefiniuj, o co toczy się gra — Klasyfikacje

W ramach jednych zawodów możesz utworzyć **dowolną liczbę niezależnych rankingów (klasyfikacji)**, z których każdy może mieć własne zasady.  
Daje to nieograniczone możliwości tworzenia angażujących scenariuszy rywalizacji.  
Twoja wyobraźnia jest jedynym ograniczeniem!

Oto kilka przykładów klasyfikacji, które możesz skonfigurować:

- **Suma Wag Wszystkich Ryb:** Absolutna klasyka — wygrywa ten, kto uzbiera największy łączny ciężar wszystkich złowionych ryb.
- **Suma Długości Wszystkich Ryb:** Idealne dla zawodów "złów i wypuść" (catch & release), gdzie liczy się każdy centymetr.
- **Największa Ryba (Waga lub Długość):** Prestiżowa nagroda dla łowcy pojedynczego, rekordowego okazu. Ty decydujesz, czy liczy się waga, czy długość.
- **"Big X" – Suma X Największych Ryb:** Bardzo popularna formuła, np. "Big 3" w zawodach karpiowych lub "Big 5" w spinningowych. System automatycznie sumuje wagę/długość X największych ryb danego zawodnika.
- **Punktacja za Gatunki:** Złożone systemy punktacji, np. 1 punkt za każdy centymetr długości plus 100 punktów bonusu za każdy unikalny gatunek powyżej wymiaru ochronnego.
- **Komplet Gatunków:** Nagroda specjalna dla zawodnika, który jako pierwszy skompletuje określony zestaw, np. złowi szczupaka, okonia i sandacza.
- **Zwycięzca Sektora:** W przypadku dużych zawodów podzielonych na sektory, możesz stworzyć oddzielny ranking dla każdego z nich.
- **Najlepszy w Kategorii:** Automatycznie generowane rankingi dla **dowolnie zdefiniowanych grup uczestników** na podstawie danych z profili (wiek, płeć, lokalizacja, drużyna, metoda połowu, gatunek).
  - **Przedziały wiekowe ustala organizator** – np. Junior do 15 lat, Senior od 55 lat, Młodzieżowiec 16–25 lat.
  - Możliwość łączenia kryteriów, np.:
    - Największa ryba w kategorii 6–12 lat, dziewczynki
    - Najdłuższa ryba dla wszystkich powyżej 45 lat
    - Łączna waga ryb w kategorii 20–50 lat
    - Największy szczupak w kategorii Senior (od 55 lat)
    - Najdłuższy okoń złowiony przez kobietę w kategorii U18
- **Dedykowany Ranking Gatunkowy:** Nagroda za największego przedstawiciela konkretnego gatunku, np. "Największy Leszcz Zawodów".
- **Pierwsza Zgłoszona Ryba Zawodów:** Prosta, ale emocjonująca kategoria dla najszybszego wędkarza.
- **"Lucky Fish" (Szczęśliwa Ryba):** Ciekawa klasyfikacja losowa, np. nagroda dla zawodnika, którego ryba miała wagę najbliższą określonej wartości (np. 2,50 kg).
- **LuckyWeight:** Odmiana "Lucky Fish", w której wartość docelowa jest losowana przed zawodami.
- **Klasyfikacja Drużynowa:** Ranking oparty na połączonych wynikach członków drużyny, np. suma wag dwóch najlepszych zawodników z zespołu.
- **Mistrz Metody:** Największa ryba złowiona określoną metodą (np. feeder, spinning, mucha).
- **Król Gatunku:** Największy przedstawiciel wybranego gatunku w danej grupie wiekowej lub płciowej.
- **Maratonista:** Największa liczba ryb złowionych w określonym czasie (np. w pierwszych 3 godzinach zawodów).
- **Najlepszy w Regionie:** Ranking dla zawodników z określonego miasta, województwa lub kraju.
- **Złota Godzina:** Największa ryba złowiona w wyznaczonym przedziale czasowym (np. między 12:00 a 13:00).
- **MultiSkill:** Suma punktów z różnych metod połowu (np. spinning + grunt).
- **Najlepszy Drużynowy w Kategorii:** Ranking drużyn w obrębie danej grupy (np. drużyny juniorów).
- **Pierwszy Gatunek:** Nagroda dla pierwszej osoby w danej kategorii, która złowi określony gatunek.
- **Najlepszy w Kategorii Wagowej:** Klasyfikacja według masy ciała zawodników (opcjonalne, jeśli dane są w profilu).

### ⚖️ Krok 2: Ustal precyzyjne zasady — Reguły Rozstrzygania Remisów

Co w sytuacji, gdy dwóch zawodników ma identyczny wynik? Fishio pozwala na zdefiniowanie **kaskadowego systemu rozstrzygania remisów** dla każdej klasyfikacji z osobna. Organizator może ustawić kolejność kryteriów, które będą sprawdzane jedno po drugim, aż do wyłonienia zwycięzcy.

**Przykład konfiguracji dla klasyfikacji "Suma Wag":**

Załóżmy, że dwóch zawodników, Jan i Piotr, uzyskało identyczną sumę wag: 15 kg. System automatycznie sprawdzi kolejne reguły:

1.  **Reguła 1 (pierwszeństwo):** W przypadku remisu w sumie wag, wygrywa zawodnik, który złowił **największą pojedynczą rybę** (wagowo).
    - _Wynik: Największa ryba Jana ważyła 5 kg, a Piotra 4,5 kg. Jan wygrywa._
2.  **Reguła 2 (jeśli Reguła 1 nie rozstrzygnie):** Jeśli nadal jest remis (identyczna suma wag i identyczna waga największej ryby), wygrywa zawodnik, który złowił **większą liczbę ryb**.
    - _Wynik: Obaj złowili po 3 ryby. Remis utrzymany, system przechodzi dalej._
3.  **Reguła 3 (ostateczność):** Jeśli i to nie rozstrzygnie remisu, o wyższym miejscu decyduje **czas zgłoszenia pierwszej ryby** (kto pierwszy, ten lepszy).
    - _Wynik: Jan zgłosił swoją pierwszą rybę o 8:15, a Piotr o 8:30. Jan zajmuje wyższe miejsce._

Dzięki temu systemowi wyniki są zawsze jednoznaczne, a zasady transparentne dla wszystkich uczestników jeszcze przed rozpoczęciem rywalizacji.

## 🏗️ Zaawansowana Struktura Rywalizacji: Ligi, Sektory i Drużyny

Fishio to nie tylko pojedyncze zawody. Platforma oferuje potężne narzędzia do budowania złożonych, wieloetapowych i angażujących struktur rywalizacji, które odzwierciedlają najbardziej wymagające formaty wędkarskie.

### 🏆 Ligi i Cykle Wieloetapowe

Chcesz zorganizować cykl Grand Prix, który potrwa cały sezon? Z Fishio to proste.

1.  **Tworzenie Ligi:** Najpierw tworzysz "kontener" dla swojej ligi, nadając mu nazwę (np. "Puchar Polski w Wędkarstwie Spławikowym 2025"), opisując ogólne zasady i definiując sponsorów całego cyklu.
2.  **Dodawanie Zawodów:** Do stworzonej ligi możesz dodawać poszczególne zawody ("tury" lub "eliminacje"). Mogą być one tworzone na bieżąco w trakcie sezonu.
3.  **Konfiguracja Punktacji Generalnej:** To serce każdej ligi. Ty decydujesz, jak będą liczone punkty do klasyfikacji generalnej:
    - **Punktacja za miejsca:** Przypisuj punkty za zajęte pozycje w każdych zawodach (np. 100 pkt za 1. miejsce, 99 za 2. itd.).
    - **Suma wyników:** Klasyfikacja generalna może być sumą wag lub długości ryb ze wszystkich zawodów cyklu.
    - **Odrzucanie najsłabszych wyników (Drop Results):** Pozwól zawodnikom na jeden słabszy występ. System może automatycznie odrzucić najgorszy wynik z np. 5 tur, co zwiększa rywalizację do samego końca.
4.  **Wyniki na Żywo:** Tabela klasyfikacji generalnej ligi aktualizuje się automatycznie po zakończeniu i zatwierdzeniu wyników każdej tury, zapewniając emocje przez cały sezon.

### 🗺️ Zarządzanie Sektorami i Losowanie Stanowisk

Duże zawody na rozległych łowiskach wymagają podziału na sektory, aby zapewnić równe szanse i ułatwić logistykę.

1.  **Definiowanie Sektorów:** Podczas tworzenia zawodów, możesz włączyć opcję podziału na sektory. Następnie tworzysz je, nadając im nazwy (np. "Sektor A", "Sektor B", "Zatoka Północna").
2.  **Przypisywanie Uczestników:** Masz pełną kontrolę nad tym, kto gdzie łowi:
    - **Losowanie:** Najbardziej sprawiedliwa metoda. Jednym kliknięciem system losowo przydziela zawodników do zdefiniowanych sektorów.
    - **Ręczne przypisanie:** Możesz ręcznie przypisać każdego zawodnika do wybranego sektora, co jest przydatne w specyficznych sytuacjach.
3.  **Losowanie Stanowisk:** Oprócz sektorów, możesz zarządzać konkretnymi, numerowanymi stanowiskami. System pozwala na ich losowanie, a wylosowany numer pojawia się na publicznej liście startowej przy nazwisku zawodnika.
4.  **Wyniki Sektorowe:** Oprócz głównej klasyfikacji generalnej zawodów, system automatycznie tworzy **osobne rankingi dla każdego sektora**. Pozwala to na przyznanie dodatkowych nagród dla "zwycięzców sektorów".

### 🤝 Rywalizacja Drużynowa

Wędkarstwo to także sport zespołowy. Fishio w pełni wspiera rywalizację drużynową.

1.  **Włączenie Trybu Drużynowego:** W ustawieniach zawodów zaznaczasz, że będą one rozgrywane w formacie drużynowym.
2.  **Tworzenie Drużyn:**
    - **Organizator tworzy drużyny:** Możesz samodzielnie zdefiniować składy i przypisać do nich zapisanych uczestników.
    - **Kapitanowie tworzą drużyny:** Możesz pozwolić, aby zawodnicy sami tworzyli drużyny. Jeden z nich zostaje kapitanem, który zaprasza pozostałych członków do swojego zespołu.
3.  **Definiowanie Zasad Punktacji Drużynowej:** Ty decydujesz, jak będzie liczony wynik zespołu:
    - **Suma wyników wszystkich członków:** Prosta suma wag/długości ryb złowionych przez cały zespół.
    - **Suma wyników X najlepszych zawodników:** Bardzo popularna reguła, np. "do wyniku drużyny liczy się suma wag 2 najlepszych zawodników".
    - **Suma punktów za miejsca:** Wynik drużyny to suma punktów sektorowych zdobytych przez jej członków.
4.  **Osobna Klasyfikacja:** Wyniki drużynowe są prezentowane w dedykowanej, osobnej tabeli "Klasyfikacja Drużynowa", która jest aktualizowana na żywo, równolegle do wyników indywidualnych.

## 🌟 Główne Funkcjonalności

### **🌍 Funkcje Publiczne (Dla Każdego Odwiedzającego)**

- **Kalendarz Zawodów i Lig:** Przeglądanie, wyszukiwanie i filtrowanie nadchodzących wydarzeń według dyscypliny, lokalizacji i daty.
- **Szczegóły Zawodów:** Dostęp do pełnych informacji o zawodach: regulamin, harmonogram, zdefiniowane klasyfikacje, nagrody i sponsorzy.
- **Wyniki na Żywo:** Publiczny dostęp (przez unikalny link) do strony wyników z aktualizacjami w czasie rzeczywistym.
- **Zaawansowane Rankingi:** Automatyczne rozstrzyganie remisów, rankingi dla kategorii (kobiety, juniorzy) i filtrów gatunków.
- **Profile Publiczne:** Strony-wizytówki dla organizatorów i łowisk, agregujące ich historię i nadchodzące wydarzenia.

### **👤 Funkcje dla Zarejestrowanych Użytkowników (Wędkarzy)**

- **Personalizowany Panel (Dashboard):** Centrum zarządzania aktywnością: nadchodzące starty, historia wyników, obserwowane ligi.
- **Zapisy i Płatności Online:** Prosty proces dołączania do zawodów i bezpieczne płatności online przez zintegrowaną bramkę.
- **Zarządzanie Profilem:** Edycja danych, które mogą być używane do automatycznej kategoryzacji w rankingach (np. wiek).
- **System Powiadomień:** Automatyczne powiadomienia (e-mail + w aplikacji) o potwierdzeniu zapisu, płatności, zbliżających się zawodach czy publikacji wyników.

### **🛠️ Funkcje dla Organizatorów Zawodów**

- **Tworzenie i Zarządzanie Zawodami:** Konfiguracja zawodów publicznych (widocznych w kalendarzu) lub prywatnych (tylko na zaproszenie przez link).
- **Elastyczne Zarządzanie Klasyfikacjami:** Tworzenie **dowolnej liczby niezależnych rankingów** w ramach jednych zawodów (np. suma wag, największa ryba, top 5 ryb, największy leszcz, etc.).
- **Zarządzanie Ligami i Cyklami:** Łączenie wielu zawodów w jeden cykl ze wspólną klasyfikacją generalną i zaawansowanymi zasadami punktacji (np. punkty za miejsca, odrzucanie najsłabszych wyników).
- **Zaawansowane Zarządzanie Uczestnikami:** Pełna kontrola nad listą startową, w tym akceptowanie/odrzucanie zapisów, przypisywanie ról (np. Sędzia) oraz **możliwość ręcznego dodawania gości — uczestników spoza platformy, którzy nie posiadają konta, ale biorą udział w zawodach.**
- **Zarządzanie Nagrodami i Sponsorami:** Możliwość dodania opisu nagrody, jej wartości oraz powiązania jej z konkretnym sponsorem, którego logo będzie widoczne przy nagrodzie.

## 🧑‍🤝‍🧑 Role użytkowników — elastyczny model ról

W Fishio nie przypisujemy stałych ról do użytkowników (np. "sędzia", "organizator", "zawodnik"). Zamiast tego — **rola użytkownika jest kontekstowa i zależna od zawodów**, w których bierze udział.

Rola użytkownika w zawodach zależy od jego relacji z danym wydarzeniem:

| Rola w zawodach | Jak ją uzyskuje użytkownik?                      |
| --------------- | ------------------------------------------------ |
| **Organizator** | Tworzy zawody w systemie                         |
| **Sędzia**      | Zostaje przypisany do zawodów przez organizatora |
| **Zawodnik**    | Dołącza do zawodów poprzez publiczny link        |

Każdy użytkownik może pełnić różne role w różnych zawodach, np.:

- Użytkownik A może być **organizatorem** jednych zawodów,
- a jednocześnie **zawodnikiem** w innych,
- i **sędzią** w jeszcze innych.

Dzięki temu modelowi możliwe jest naturalne odwzorowanie rzeczywistych ról w społeczności wędkarskiej — elastyczne, zależne od kontekstu i zmienne w czasie.

### A co z gośćmi? Uczestnicy spoza platformy

Oprócz zarejestrowanych użytkowników, którzy samodzielnie dołączają do zawodów, organizator ma możliwość **ręcznego dodania 'Gościa'**. Jest to specjalny typ uczestnika, który nie posiada konta w systemie Fishio. Organizator po prostu wpisuje jego imię i nazwisko. Gość taki pojawia się na liście startowej i w tabeli wyników, a sędziowie mogą normalnie rejestrować jego połowy. Jest to idealne rozwiązanie dla osób, które nie chcą się rejestrować, biorą udział jednorazowo lub zostały dopisane w ostatniej chwili.

### 🎯 Przykłady:

- **Tomasz** tworzy zawody "Puchar Mazur 2025" → automatycznie staje się ich **organizatorem**.
- **Anna** otrzymuje od Tomasza uprawnienia sędziego → może dodawać połowy uczestników jako **sędzia**.
- **Michał** znajduje link do zawodów i zapisuje się → zostaje dodany do listy oczekujących i w zależności od decyzji organizatora staje się **zawodnikiem** w tych zawodach lub jest odrzucony.
- **Tomasz** dodaje ręcznie swojego kolegę **Pawła** jako **gościa**, ponieważ Paweł nie ma konta w serwisie. Paweł pojawia się na liście startowej.
- W tym samym czasie **Michał** może być **organizatorem** innego cyklu zawodów.

### 📋 Szczegółowy opis ról:

- **Organizator:** Posiada pełne uprawnienia do tworzenia i zarządzania zawodami, uczestnikami oraz finansami. Może również pełnić rolę sędziego w swoich zawodach.
- **Sędzia:** Użytkownik wyznaczony przez organizatora, którego głównym zadaniem jest rejestrowanie połowów w trakcie trwania zawodów. Może być sędzią w wielu różnych zawodach jednocześnie.
- **Uczestnik (Zawodnik):** Każdy zarejestrowany użytkownik, który dołączył do konkretnych zawodów, może śledzić swoje wyniki i zarządzać swoim profilem. Ten sam użytkownik może być uczestnikiem wielu zawodów równocześnie.
- **Gość:** Niezarejestrowany uczestnik dodany ręcznie przez organizatora. Bierze pełnoprawny udział w rywalizacji, ale nie posiada dostępu do panelu użytkownika.

## 💻 Stos Technologiczny

### **Backend (.NET 10)**

- **Architektura**: Clean Architecture (Domain, Application, Infrastructure, API)
- **Wzorce**: CQRS z MediatR, Repository Pattern
- **ORM**: Entity Framework Core
- **Baza danych**: PostgreSQL 🐘
- **Autentykacja**: Clerk Integration 🔑
- **API**: Minimal API

### **Frontend (Next.js)**

- **Framework**: Next.js 15+ (App Router) 🖥️
- **Language**: TypeScript
- **UI**: shadcn/ui + TailwindCSS 🎨
- **Zarządzanie Stanem**: Zustand (client), TanStack Query (server) 🧠
- **Formularze**: TanStack Form 📝
- **Mobile-First**: Responsive design

### **Infrastruktura**

- **Hosting Plików**: S3 ☁️
- **Płatności**: Integracja z bramką płatniczą (PayU, Przelewy24) 💳
- **Powiadomienia**: Email + In-app notifications
- **Real-time**: SignalR dla live results

## 🚀 Kierunki dalszego rozwoju

Platforma jest stale rozwijana. Główne kierunki na przyszłość to:

- **Wsparcie dla zawodów drużynowych.**
- **Zarządzanie sektorami i losowanie stanowisk.**
- **Szablony zawodów** do szybkiego tworzenia cyklicznych imprez.
- **Rozbudowane statystyki** dla zawodników i łowisk.
- **Tie-Breaking Rules**: Automatyczne rozstrzyganie remisów według konfigurowalnych reguł
- **Elastyczne Metody Obliczania**: Suma wag, długości, największa ryba, top X ryb
- **Kategorie Uczestników**: Automatyczne rankingi dla kobiet, mężczyzn, juniorów, seniorów
- **Filtry Gatunków**: Dedykowane rankingi dla konkretnych gatunków ryb

### **🏆 Strukturalne Ligi i Cykle**

- **Punktacja Pozycyjna**: Konfiguracja punktów za zajęte miejsca w zawodach
- **Drop Results**: Możliwość odrzucania najsłabszych wyników z klasyfikacji generalnej
- **Wieloetapowe Cykle**: Łączenie zawodów w ligi z automatyczną punktacją
- **Dynamiczne Tabele**: Real-time aktualizacja klasyfikacji generalnej

### **📁 Centralne Zarządzanie Mediami**

- **Attachment System**: Ujednolicone zarządzanie zdjęciami, logami i dokumentami
- **Automatyczne Metadane**: Tytuły, opisy, rozmiary plików, typy MIME
- **Cloudinary Integration**: Optymalizacja i transformacja obrazów
- **Bezpieczne Przechowywanie**: Kontrola dostępu i auditing

### **🏠 Zaawansowane Profile Łowisk**

- **Address Value Objects**: Strukturalne dane adresowe z walidacją
- **GPS Coordinates**: Precyzyjne lokalizacje z mapami
- **Profile Właścicieli**: Historia i reputacja łowisk
- **Agregacja Wydarzeń**: Wszystkie zawody na danym łowisku

### **💰 Kompleksowy System Płatności**

- **Multi-Gateway Support**: PayU, Przelewy24, Stripe
- **Status Tracking**: Real-time śledzenie statusu płatności
- **Automatic Confirmation**: Automatyczne potwierdzanie uczestnictwa po płatności
- **Refund Support**: Obsługa zwrotów i anulowań

### **🔔 Inteligentny System Powiadomień**

- **Multi-Channel**: Email + in-app notifications
- **Event-Driven**: Automatyczne powiadomienia o kluczowych wydarzeniach
- **Personalizacja**: Konfigurowane preferencje użytkowników
- **Rich Content**: Powiadomienia z linkami do powiązanych zasobów

## 🚀 Dalszy Rozwój (Roadmap)

Fishio będzie stale rozwijane. Po udostępnieniu wersji MVP, skupimy się na kolejnych funkcjach:

- ➡️ **Zaawansowane Profile Społecznościowe:** Możliwość dodawania znajomych, tworzenia grup i śledzenia ich aktywności.
- ➡️ **Integracje z Mediami Społecznościowymi:** Automatyczne generowanie i udostępnianie grafik z wynikami i listami startowymi.
- ➡️ **System Rezerwacji Stanowisk:** Moduł dla właścicieli łowisk do zarządzania rezerwacjami poza zawodami.
- ➡️ **Zaawansowany Moduł Sponsoringu:** Dedykowane panele dla sponsorów ze statystykami i możliwościami promocyjnymi.
